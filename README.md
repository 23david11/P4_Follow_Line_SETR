# P4_Follow_Line_SETR

Para realizar esta practica, la hemos dividido en dos principales partes, el sigue lineas y la comunicacion.

En la parte de comunicacion, lo primero que hemos implementado ha sido la comunicacion en serie. Practicamente no hemos cambiado nada de los codigos de ejemplo. Hemos aprovechado tambien para enviar un mensaje acabado en '}', como se hacia en el codigo proporcionado, para indicar a la placa arduino que la esp32 ya se ha conectado al wifi.
Para tratar los mensajes enviados por el arduino, primero los recogiamos en un buffer que detectava el final del mensaje con un caracter especial que enviavamos nosotros y otro caracter, para que en caso de que en esa accion recivida tambien trajese datos, almacenase estos en otro buffer. Esta implementacion nos fallaba en el ultimo mensaje recibido y daba muchos errores de funcionamiento a la hora de detectar que tipo de accion le llegaba en la funcion "controller_messages() ". 
Asique en una segunda implementacion, recogemos todo el string recibido hasta detectar el caracter de salto de linea '\n' en un unico buffer, y este se le proporciona a la funcion que depura este buffer. Ahora detectamos si el mensaje trae datos indicando un delimitador que nos indica si este existe o no. Si existe, separara la accion y el dato en dos strings diferentes, mientras que si solo se ha recibido  una accion no guardara nada en datos. Para que funcionen bien las comparciones de las diferentes acciones borramos el ultimo caracter del string.
Por ultimo, para implementar los mensajes JSON, lo hacemos sin usar ninguna libreria, solo detectamos cuantas de las tres opciones que puede llevar este mensaje le pasamos a la funcion encargada de crear estos mensjes y esta envia dichos mensajes con la informacion proporcionada.
